# ComfyUI Camera Raw 插件

参考 Photoshop Camera Raw 滤镜的图像调整插件，提供10个独立的图像调整节点。

## 安装

1. 将 `ComfyUI_CameraRaw` 文件夹复制到 ComfyUI 的 `custom_nodes` 目录
2. 安装依赖：
```bash
pip install -r requirements.txt
```

## 节点说明

### 1. 亮 (Brightness)
亮度调整节点，包含以下参数：
- **曝光 (Exposure)**: -5.0 到 5.0，调整整体亮度
- **对比度 (Contrast)**: -100 到 100，调整图像对比度
- **高光 (Highlights)**: -100 到 100，调整高光区域
- **阴影 (Shadows)**: -100 到 100，调整阴影区域
- **白色 (Whites)**: -100 到 100，调整白色点
- **黑色 (Blacks)**: -100 到 100，调整黑色点

### 2. 颜色 (Color)
颜色调整节点，包含以下参数：
- **温度 (Temperature)**: -100 到 100，调整色温（蓝色到黄色）
- **色调 (Tint)**: -150 到 150，调整色调（绿色到洋红）
- **自然饱和度 (Vibrance)**: -100 到 100，智能饱和度调整
- **饱和度 (Saturation)**: -100 到 100，整体饱和度调整

### 3. 效果 (Effects)
效果调整节点，包含以下参数：
- **清晰度 (Clarity)**: -100 到 100，局部对比度增强
- **去雾 (Dehaze)**: -100 到 100，去除或添加雾霾效果
- **晕影 (Vignette)**: -100 到 100，添加或去除边缘暗角
- **颗粒 (Grain)**: 0 到 100，添加胶片颗粒效果

### 4. 曲线 (Curves)
色调曲线调整节点：
- **曲线点 (Curve Points)**: 字符串格式，例如 "0,0 128,128 255,255"，定义曲线控制点

### 5. 混色器 (Color Mixer)
HSL 颜色混合器，可调整8种颜色的色相、饱和度和亮度：
- 红色 (Red)
- 橙色 (Orange)
- 黄色 (Yellow)
- 绿色 (Green)
- 青色 (Aqua)
- 蓝色 (Blue)
- 紫色 (Purple)
- 洋红 (Magenta)

每种颜色都有三个参数：
- **色相 (Hue)**: -180 到 180
- **饱和度 (Saturation)**: -100 到 100
- **亮度 (Luminance)**: -100 到 100

### 6. 颜色分级 (Color Grading)
分离色调节点，可分别调整高光、中间调和阴影的色调：
- **高光色相/饱和度**: 0 到 360 / 0 到 100
- **中间调色相/饱和度**: 0 到 360 / 0 到 100
- **阴影色相/饱和度**: 0 到 360 / 0 到 100
- **平衡 (Balance)**: -100 到 100，调整高光和阴影的分界点

### 7. 细节 (Details)
细节调整节点，包含锐化和降噪功能：
- **锐化 (Sharpening)**: 0 到 150，锐化强度
- **半径 (Radius)**: 0.5 到 3.0，锐化半径
- **细节 (Detail)**: 0 到 100，细节增强程度
- **蒙版 (Masking)**: 0 到 100，保护平滑区域
- **亮度降噪 (Luminance Noise)**: 0 到 100，减少亮度噪点
- **颜色降噪 (Color Noise)**: 0 到 100，减少颜色噪点

### 8. 光学 (Optics)
镜头校正节点：
- **色差 (Chromatic Aberration)**: -100 到 100，校正色差
- **畸变 (Distortion)**: -100 到 100，校正镜头畸变
- **晕影校正 (Vignette Correction)**: -100 到 100，校正边缘暗角

### 9. 镜头模糊 (Lens Blur)
镜头模糊效果节点：
- **模糊量 (Blur Amount)**: 0 到 100，模糊强度
- **焦距距离 (Focal Distance)**: 0.0 到 1.0，焦点位置
- **光圈 (Aperture)**: 1.4 到 22.0，光圈大小（影响景深）

### 10. 校准 (Calibration)
相机校准节点，可调整 RGB 三个通道：
- **红色/绿色/蓝色色相**: -100 到 100
- **红色/绿色/蓝色饱和度**: -100 到 100

## 使用方法

1. 在 ComfyUI 中添加图像输入节点
2. 连接图像到任意 Camera Raw 节点
3. 调整节点参数
4. 可以串联多个节点进行组合调整
5. 连接输出到显示或保存节点

## 注意事项

- 所有节点都接受 IMAGE 类型输入
- 参数范围已设置为合理值，可根据需要调整
- 多个节点可以串联使用，实现复杂的图像调整流程
- 某些效果（如镜头模糊）计算量较大，可能需要较长时间处理

## 依赖

- numpy >= 1.21.0
- Pillow >= 9.0.0
- scipy >= 1.7.0


# ComfyUI Camera Raw 插件安装说明

## 安装步骤

1. **将整个 `ComfyUI_CameraRaw` 文件夹复制到 ComfyUI 的自定义节点目录：**
   ```
   ComfyUI/custom_nodes/ComfyUI_CameraRaw/
   ```

2. **安装依赖（可选，用于更高质量的处理）：**
   ```bash
   pip install scipy
   ```
   注意：如果没有安装 scipy，插件会自动使用 PIL 的降级实现，功能仍然可用。

3. **重启 ComfyUI**

4. **在节点菜单中找到节点**

   所有节点位于菜单分类：`image/postprocessing/camera_raw`
   
   节点名称都带有 🔵BB 前缀标识，便于识别。

## 节点列表

1. **🔵BB Camera Raw - 亮度调整**
   - 曝光、对比度、高光、阴影、白色、黑色

2. **🔵BB Camera Raw - 颜色调整**
   - 白平衡预设、色温、色调、自然饱和度、饱和度

3. **🔵BB Camera Raw - 效果调整**
   - 纹理、清晰度、去薄雾

4. **🔵BB Camera Raw - 曲线调整**
   - 曲线预设、高光、亮部、暗部、阴影

5. **🔵BB Camera Raw - HSL 混色器**
   - 8 种颜色的色相、饱和度、明度调整

6. **🔵BB Camera Raw - 颜色分级**
   - 阴影、中间调、高光的分离色调

7. **🔵BB Camera Raw - 细节调整**
   - 锐化、降噪

8. **🔵BB Camera Raw - 光学调整**
   - 去色差、晕影

9. **🔵BB Camera Raw - 校准**
   - 阴影色调、原色调整

## 使用说明

### 基础工作流

```
加载图像 → 亮度调整 → 颜色调整 → 效果调整 → 保存图像
```

### 完整工作流

```
加载图像 → 校准 → 亮度调整 → 曲线调整 → 颜色调整 → HSL 混色器 → 颜色分级 → 效果调整 → 细节调整 → 光学调整 → 保存图像
```

### 灵活组合

可以根据需要只使用部分节点，例如：
- 只需要调色：加载图像 → 颜色调整 → 保存图像
- 只需要锐化：加载图像 → 细节调整 → 保存图像

### 节点连接顺序建议

- 校准应最先处理（如果使用）
- 亮度调整通常放在颜色调整之前
- 细节调整（锐化）建议放在最后
- 光学调整（晕影）可以放在最后

## 参数说明

所有参数标签都已中文化，在节点界面中可以直接看到中文标签。

## 常见问题

### Q: 节点没有出现在菜单中？
A: 
- 确认文件夹已放在 `custom_nodes` 目录下
- 检查文件夹名称是否正确：`ComfyUI_CameraRaw`
- 确认 `__init__.py` 文件存在
- 检查 ComfyUI 控制台是否有错误信息
- 尝试完全重启 ComfyUI

### Q: 处理速度慢？
A: 
- Camera Raw 滤镜涉及大量图像处理，处理大图像时可能需要较长时间
- 可以先缩小图像尺寸进行测试
- 安装 scipy 可以提高某些功能的处理速度

### Q: 效果不理想？
A: 
- 建议逐步调整参数，不要一次性调整过多
- 可以先使用曝光和对比度，再使用纹理和清晰度
- 注意参数范围，过大可能导致图像失真

## 文件结构

```
ComfyUI_CameraRaw/
├── __init__.py          # 插件入口，注册所有节点
├── utils.py            # 工具类（RGB/HSV 转换）
├── brightness.py       # 亮度调整节点
├── color.py            # 颜色调整节点
├── effects.py          # 效果调整节点
├── curves.py           # 曲线调整节点
├── hsl.py              # HSL 混色器节点
├── color_grading.py    # 颜色分级节点
├── details.py          # 细节调整节点
├── optics.py           # 光学调整节点
├── calibration.py     # 校准节点
├── README.md           # 说明文档（英文）
└── 安装说明.md         # 安装说明（中文）
```

